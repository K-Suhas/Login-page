<div class="container">
  <!-- Header row -->
  <div class="header">
    <button class="home-button" (click)="toggleSidebar()">ğŸ  Home</button>
    <h2>Admin Dashboard</h2>
    <app-notification-bell></app-notification-bell>
  </div>

  <!-- Sidebar -->
  <div class="sidebar" *ngIf="showSidebar">
    <div class="sidebar-header">
      <h3>Navigation</h3>
      <!-- Home button inside sidebar acts as close -->
      <button class="home-button" (click)="toggleSidebar()">ğŸ  Home</button>
    </div>
    <button class="sidebar-button" (click)="goToStudentInfo()">Student Info</button>
    <button class="sidebar-button" (click)="goToCourses()">Courses</button>
    <button class="sidebar-button" (click)="goToMarksheet()">Marksheet</button>
    <button class="sidebar-button" (click)="goToTeacherManagement()">Teachers</button>
    <button class="sidebar-button" (click)="goToDepartment()">Departments</button>

  </div>

  <!-- Add Admin button -->
  <div class="admin-actions">
    <button class="primary-button" (click)="toggleAddAdminForm()">
      â• Add New Admin
    </button>
  </div>

  <!-- Add Admin form -->
  <div *ngIf="showAddAdminForm" class="admin-form">
    <h3>New Admin Details</h3>
    <form (ngSubmit)="addAdmin()">
      <label>Name</label>
      <input [(ngModel)]="newAdmin.name" name="adminName" type="text" />

      <label>Email</label>
      <input [(ngModel)]="newAdmin.email" name="adminEmail" type="email" />

      <div class="form-row">
        <button type="submit" class="primary-button">Submit</button>
        <button type="button" class="secondary-button" (click)="toggleAddAdminForm()">Cancel</button>
      </div>
    </form>
    <div class="admin-status" [class.error]="adminMessage.startsWith('âŒ')">{{ adminMessage }}</div>
  </div>


  
  <!-- Report button -->
  <div class="unified-buttons">
    <button class="report-button" (click)="generateReport()">ğŸ“Š Generate Student Report</button>
  </div>

  <!-- Report progress -->
  <div *ngIf="reportJobId" class="report-status">
    <p>{{ reportMessage }}</p>
    <div class="progress-bar-container">
      <div class="progress-bar" [style.width.%]="reportProgress"></div>
    </div>
    <p class="percent">{{ reportProgress }}%</p>
  </div>

  <!-- Students and Courses -->
  <div class="side-by-side">
    <!-- Students panel -->
    <div class="panel">
      <h3>Students</h3>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Department</th><th>Email</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of paginatedStudents">
            <td>{{ s.id }}</td>
            <td>{{ s.name }}</td>
            <td>{{ s.departmentName }}</td>
            <td>{{ s.email }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevStudentPage()">Prev</button>
        <span>Page {{ studentPage + 1 }}</span>
        <button (click)="nextStudentPage()">Next</button>
      </div>
    </div>

    <!-- Courses panel -->
    <div class="panel">
      <h3>Courses</h3>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Students</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of paginatedCourses">
            <td>{{ c.id }}</td>
            <td>{{ c.name }}</td>
            <td>{{ c.studentNames?.length || 0 }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevCoursePage()">Prev</button>
        <span>Page {{ coursePage + 1 }}</span>
        <button (click)="nextCoursePage()">Next</button>
      </div>
    </div>
  </div>

  <!-- Graph -->
  <div class="graph-section">
    <app-percentage-graph></app-percentage-graph>
  </div>

  <!-- Mail -->
  <div class="mail-section">
    <h3>Send Mail</h3>
    <form (ngSubmit)="sendMail()">
      <label>To</label>
      <select [(ngModel)]="toEmail" name="toEmail">
        <option value="ALL">ALL</option>
        <option *ngFor="let s of students" [value]="s.email">{{ s.name }} ({{ s.email }})</option>
      </select>

      <label>Subject</label>
      <input [(ngModel)]="subject" name="subject" type="text" />

      <label>Body</label>
      <textarea [(ngModel)]="body" name="body"></textarea>

      <button type="submit">Send</button>
    </form>
    <div class="mail-status" [class.error]="mailMessage.startsWith('âŒ')">{{ mailMessage }}</div>
  </div>
</div>
