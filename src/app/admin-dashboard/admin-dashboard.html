<div class="container">
  <h2>Admin Dashboard</h2>

  <div *ngIf="loading" class="loading">Loading dashboard...</div>
   <app-notification-bell></app-notification-bell>

  <div *ngIf="!loading" class="side-by-side">
    <!-- Student Info -->
    <div class="panel">
      <h3>Student Info</h3>
      <table *ngIf="paginatedStudents.length > 0">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Department</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let student of paginatedStudents">
            <td>{{ student.id }}</td>
            <td>{{ student.name }}</td>
            <td>{{ student.dept }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevStudentPage()" [disabled]="studentPage === 0">Previous</button>
        <span>Page {{ studentPage + 1 }}</span>
        <button (click)="nextStudentPage()" [disabled]="(studentPage + 1) * pageSize >= students.length">Next</button>
      </div>
    </div>

    <!-- Course Info -->
    <div class="panel">
      <h3>Courses</h3>
      <table *ngIf="paginatedCourses.length > 0">
        <thead>
          <tr><th>ID</th><th>Name</th><th>Enrolled Students</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let course of paginatedCourses">
            <td>{{ course.id }}</td>
            <td>{{ course.name }}</td>
            <td>{{ course.studentNames?.join(', ') || 'None' }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevCoursePage()" [disabled]="coursePage === 0">Previous</button>
        <span>Page {{ coursePage + 1 }}</span>
        <button (click)="nextCoursePage()" [disabled]="(coursePage + 1) * pageSize >= courses.length">Next</button>
      </div>
    </div>
  </div>

  <!-- Graph Section -->
  <div class="graph-section">
    <h3>Percentage Distribution</h3>
    <app-percentage-graph></app-percentage-graph>
  </div>

  <!-- Mail Section -->
<div class="mail-section">
  <h3>ðŸ“¢ Send Announcement</h3>
  <form (ngSubmit)="sendMail()">
    <label>Recipient:</label>
    <select [(ngModel)]="toEmail" name="toEmail">
      <option value="ALL">All Students</option>
      <option *ngFor="let student of students" [value]="student.email">
        {{ student.name }} ({{ student.email }})
      </option>
    </select>

    <label>Subject:</label>
    <input [(ngModel)]="subject" name="subject" placeholder="Enter subject..." required />

    <label>Body:</label>
    <textarea [(ngModel)]="body" name="body" placeholder="Write your announcement..." required></textarea>

    <button type="submit">ðŸš€ Send Mail</button>
  </form>

  <p *ngIf="mailMessage" class="mail-status">{{ mailMessage }}</p>
</div>


  <!-- Navigation -->
  <div class="unified-buttons">
    <button class="primary-button large-button" (click)="goToHome()">Go to Home Page</button>
  </div>
</div>
