<!-- src/app/admin-dashboard/admin-dashboard.html -->

<div class="header">
  <h2>Admin Dashboard</h2>
  <app-notification-bell></app-notification-bell>
</div>
<div class="header-actions">
    <button class="home-button" (click)="goToHome()">ğŸ  Home</button>
  </div>

<div class="container">
   <div class="unified-buttons">
  <button class="report-button" (click)="generateReport()">
    ğŸ“Š Generate Student Report
  </button>
</div>
<div *ngIf="reportJobId" class="report-status">
  <p>{{ reportMessage }}</p>
  <div class="progress-bar-container">
    <div class="progress-bar" [style.width.%]="reportProgress"></div>
  </div>
  <p class="percent">{{ reportProgress }}%</p>
</div>

  <div class="side-by-side">
    <div class="panel">
      <h3>Students</h3>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Department</th><th>Email</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of paginatedStudents">
            <td>{{ s.id }}</td>
            <td>{{ s.name }}</td>
            <td>{{ s.dept }}</td>
            <td>{{ s.email }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevStudentPage()">Prev</button>
        <span>Page {{ studentPage + 1 }}</span>
        <button (click)="nextStudentPage()">Next</button>
      </div>
    </div>

    <div class="panel">
      <h3>Courses</h3>
      <table>
        <thead>
          <tr><th>ID</th><th>Name</th><th>Students</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let c of paginatedCourses">
            <td>{{ c.id }}</td>
            <td>{{ c.name }}</td>
            <td>{{ c.studentNames?.length || 0 }}</td>
          </tr>
        </tbody>
      </table>
      <div class="pagination-controls">
        <button (click)="prevCoursePage()">Prev</button>
        <span>Page {{ coursePage + 1 }}</span>
        <button (click)="nextCoursePage()">Next</button>
      </div>
    </div>
  </div>


 

  <div class="graph-section">
    <app-percentage-graph></app-percentage-graph>
  </div>

   <div class="mail-section">
    <h3>Send Mail</h3>
    <form (ngSubmit)="sendMail()">
      <label>To</label>
      <select [(ngModel)]="toEmail" name="toEmail">
        <option value="ALL">ALL</option>
        <option *ngFor="let s of students" [value]="s.email">{{ s.name }} ({{ s.email }})</option>
      </select>

      <label>Subject</label>
      <input [(ngModel)]="subject" name="subject" type="text" />

      <label>Body</label>
      <textarea [(ngModel)]="body" name="body"></textarea>

      <button type="submit">Send</button>
    </form>
    <div class="mail-status" [class.error]="mailMessage.startsWith('âŒ')">{{ mailMessage }}</div>
  </div>
  
 

</div>
